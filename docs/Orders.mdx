export const metadata = {
  title: 'Orders (PHP SDK)',
  description:
    'Learn how to retrieve orders using the Vatly PHP SDK.',
}

# Orders

Orders are created automatically when a checkout completes successfully or when a subscription renews. {{ className: 'lead' }}

## The Order Resource

Below you'll find all properties for the Vatly Order resource.

### Properties

<Properties>
  <Property name="id" type="string">
    Unique identifier for the order (`ord_...`).
  </Property>
  <Property name="status" type="string">
    The status: `pending`, `paid`, `failed`, or `refunded`.
  </Property>
  <Property name="customerId" type="string">
    The customer ID.
  </Property>
  <Property name="checkoutId" type="string|null">
    The checkout ID (for initial orders).
  </Property>
  <Property name="subscriptionId" type="string|null">
    The subscription ID (for recurring orders).
  </Property>
  <Property name="amount" type="integer">
    Total amount in cents.
  </Property>
  <Property name="currency" type="string">
    Three-letter ISO currency code.
  </Property>
  <Property name="taxAmount" type="integer">
    Tax amount in cents.
  </Property>
  <Property name="testmode" type="bool">
    Whether this is a test order.
  </Property>
  <Property name="metadata" type="array">
    Your custom metadata.
  </Property>
  <Property name="paidAt" type="string|null">
    When the order was paid (ISO 8601).
  </Property>
  <Property name="createdAt" type="string">
    Creation timestamp (ISO 8601).
  </Property>
</Properties>

---

## Retrieve an order {{ tag: 'GET', label: '/v1/orders/:id' }}

<Row>
  <Col>

    Retrieve an order by its ID.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/orders/:id">

    ```php {{ title: 'PHP' }}
    $order = $vatly->orders->get('ord_abc123');

    echo $order->status;
    echo $order->amount / 100 . ' ' . $order->currency;

    if ($order->isPaid()) {
        echo 'Paid at: ' . $order->paidAt;
    }
    ```

    </CodeGroup>

  </Col>
</Row>

---

## List all orders {{ tag: 'GET', label: '/v1/orders' }}

<Row>
  <Col>

    Retrieve a paginated list of all orders.

    ### Optional attributes

    <Properties>
      <Property name="limit" type="integer">
        The number of orders to return (default: 10, max: 100).
      </Property>
      <Property name="startingAfter" type="string">
        A cursor for pagination.
      </Property>
      <Property name="customerId" type="string">
        Filter by customer ID.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/orders">

    ```php {{ title: 'PHP' }}
    $orders = $vatly->orders->list();

    foreach ($orders as $order) {
        echo $order->id . ': ' . ($order->amount / 100) . ' ' . $order->currency;
    }

    // Filter by customer
    $orders = $vatly->orders->list([
        'customerId' => 'cus_abc123',
    ]);
    ```

    </CodeGroup>

  </Col>
</Row>

---

## Order statuses

| Status | Description |
|--------|-------------|
| `pending` | Order is awaiting payment |
| `paid` | Payment successful |
| `failed` | Payment failed |
| `refunded` | Order has been refunded |

---

## Helper methods

<Row>
  <Col>

    The Order object provides convenient helper methods.

  </Col>
  <Col sticky>

    ```php {{ title: 'PHP' }}
    $order->isPaid();      // true if status is 'paid'
    $order->isPending();   // true if status is 'pending'
    $order->isFailed();    // true if status is 'failed'
    $order->isRefunded();  // true if status is 'refunded'
    ```

  </Col>
</Row>
